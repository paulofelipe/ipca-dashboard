<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>IPCA</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,alt,wide.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,alt,wide.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_import/components/locale.aadda7be.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/zip.js">
<link rel="modulepreload" href="./_npm/arquero@5.4.1/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.15/_esm.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/_esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/_esm.js">
<link rel="modulepreload" href="./_npm/jszip@3.10.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/apache-arrow@16.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/acorn@8.12.1/_esm.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/_esm.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/tslib@2.6.3/_esm.js">
<link rel="modulepreload" href="./_npm/flatbuffers@24.3.25/_esm.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/_esm.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/_esm.js">
<link rel="icon" href="./_file/observable.1af93621.png" type="image/png" sizes="32x32">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile} from "./_observablehq/stdlib.js";

registerFile("./data/ipca.zip", {"name":"./data/ipca.zip","mimeType":"application/zip","path":"./_file/data/ipca.4f03791b.zip","lastModified":1721182302009});

define({id: "4fb6b65a", outputs: ["locale","number_locale"], body: async () => {
const {locale, number_locale} = await import("./_import/components/locale.aadda7be.js");

return {locale,number_locale};
}});

define({id: "6985dcd8", inputs: ["FileAttachment","d3"], outputs: ["ipca_zip","ipca_serie","ipca_grupo","ipca_subitem"], body: async (FileAttachment,d3) => {
const ipca_zip = FileAttachment("./data/ipca.zip").zip();
let ipca_serie = await ipca_zip.then((zip) => zip.file("ipca_serie.csv").csv({ typed: true }));
ipca_serie.map(
  d => {
    d.ano = +d3.utcFormat("%Y")(d.data);
    d.mes = d3.utcFormat("%B")(d.data);
  }
)

let ipca_grupo = await ipca_zip.then((zip) => zip.file("ipca_grupo.csv").csv({ typed: true }));
ipca_grupo.map(
  d => {
    d.ano = +d3.utcFormat("%Y")(d.data);
    d.mes = d3.utcFormat("%B")(d.data);
  }
)

let ipca_subitem = await ipca_zip.then((zip) => zip.file("ipca_subitem.csv").csv({ typed: true }));
ipca_subitem.map(
  d => {
    d.ano = +d3.utcFormat("%Y")(d.data);
    d.mes = d3.utcFormat("%B")(d.data);
  }
)
return {ipca_zip,ipca_serie,ipca_grupo,ipca_subitem};
}});

define({id: "e312573b", inputs: ["d3","ipca_serie","aq"], outputs: ["data_max","data_min","ano_atual","mes_atual","var_mensal","var_acum_ano","var_acum_12m"], body: async (d3,ipca_serie,aq) => {
const data_max = d3.max(await ipca_serie, d => d.data)
const data_min = d3.utcMonth.offset(data_max, -11)
const ano_atual = d3.utcFormat("%Y")(data_max)
const mes_atual = d3.utcFormat("%B")(data_max)

const var_mensal = aq.from(ipca_serie)
  .filter(d => d.variavel == "IPCA - Variação mensal (%)")
  .filter(aq.escape(d => d.data == data_max))
  .objects()

const var_acum_ano = aq.from(ipca_serie)
  .filter(d => d.variavel == "IPCA - Variação acumulada no ano (%)")
  .filter(d => d.data == aq.op.max(d.data))
  .objects()

const var_acum_12m = aq.from(ipca_serie)
  .filter(d => d.variavel == "IPCA - Variação acumulada em 12 meses (%)")
  .filter(d => d.data == aq.op.max(d.data))
  .objects()
return {data_max,data_min,ano_atual,mes_atual,var_mensal,var_acum_ano,var_acum_12m};
}});

define({id: "ecbe3c53", outputs: ["series"], body: () => {
const series = [
  "IPCA - Variação mensal (%)",
  "IPCA - Variação acumulada no ano (%)",
  "IPCA - Variação acumulada em 12 meses (%)"
]
return {series};
}});

define({id: "97b1525c", mode: "inline", inputs: ["number_locale","var_mensal","display"], body: async (number_locale,var_mensal,display) => {
display(await(
number_locale.format(".2%")(var_mensal[0]["valor"] / 100)
))
}});

define({id: "4a097ad1", mode: "inline", inputs: ["d3","data_max","display"], body: async (d3,data_max,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_max)
))
}});

define({id: "a5925173", mode: "inline", inputs: ["number_locale","var_acum_ano","display"], body: async (number_locale,var_acum_ano,display) => {
display(await(
number_locale.format(".2%")(var_acum_ano[0]["valor"] / 100)
))
}});

define({id: "4a097ad1-1", mode: "inline", inputs: ["d3","data_max","display"], body: async (d3,data_max,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_max)
))
}});

define({id: "398007da", mode: "inline", inputs: ["number_locale","var_acum_12m","display"], body: async (number_locale,var_acum_12m,display) => {
display(await(
number_locale.format(".2%")(var_acum_12m[0]["valor"] / 100)
))
}});

define({id: "9f7fb85d", mode: "inline", inputs: ["d3","data_min","display"], body: async (d3,data_min,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_min)
))
}});

define({id: "4a097ad1-2", mode: "inline", inputs: ["d3","data_max","display"], body: async (d3,data_max,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_max)
))
}});

define({id: "864e3729", inputs: ["Inputs","series","Generators"], outputs: ["input_serie","serie"], body: (Inputs,series,Generators) => {
const input_serie = Inputs.select(
  series, {
    label: "Série",
    format: x => x.slice(7),
    value: series[0],
    width: 360
  });
const serie = Generators.input(input_serie);
return {input_serie,serie};
}});

define({id: "a81b4d46", inputs: ["aq","ipca_serie","mes_atual"], outputs: ["comparacao_mes","comparacao_acum"], body: (aq,ipca_serie,mes_atual) => {
const comparacao_mes = aq.from(ipca_serie)
  .filter(d => d.variavel == "IPCA - Variação mensal (%)")
  .filter(aq.escape(d => d.mes == mes_atual))
  .objects()

const comparacao_acum = aq.from(ipca_serie)
  .filter(d => d.variavel == "IPCA - Variação acumulada no ano (%)")
  .filter(aq.escape(d => d.mes == mes_atual))
  .objects()
return {comparacao_mes,comparacao_acum};
}});

define({id: "4d25d951", inputs: ["ipca_serie","Plot","d3","number_locale","anim_line","aq","mes_atual","anim_vbar"], outputs: ["plot_serie","plot_comparacao_mes"], body: (ipca_serie,Plot,d3,number_locale,anim_line,aq,mes_atual,anim_vbar) => {
function plot_serie(width, serie) {
  const data_plot = ipca_serie.filter(d => d.variavel == serie);
  const height = 250;
  const plot = Plot.plot({
      width,
      marginTop: 40,
      marginBottom: 40,
      height: height,
      y: {
        label: "Variação (%)",
      },
      x: {
        tickFormat: d3.utcFormat("%b/%Y"),
        label: "Data",
        insetLeft: 36,
        tickSize: 0,
      },
      style: {
        fontSize: "12px",
      },
      marks: [
        Plot.axisY({
          tickSize: 0, // don’t draw ticks
          dx: 38, // offset right
          dy: -6, // offset up
          lineAnchor: "bottom", // draw labels above grid lines
          tickFormat: (d) => number_locale.format(".1%")(d)
        }),
        Plot.gridY({
          strokeDasharray: "5 5", // dashed
          strokeOpacity: 1, // opaque
          strokeWidth: 0.2  
        }),
        Plot.line(data_plot, {
          x: "data",
          y: d => d.valor / 100,
          stroke: "var(--theme-foreground-focus)",
          tip: {
            format: {
              x: d => d3.utcFormat("%b/%Y")(d),
              y: (d) => number_locale.format(".2%")(d),
            }
          },
          render: anim_line
        })
      ]
    });

    return plot;
}

function plot_comparacao_mes(width, serie) {
  const data_plot = aq.from(ipca_serie)
    .filter(aq.escape(d => d.variavel == serie))
    .filter(aq.escape(d => d.mes == mes_atual))
    .objects();

  const plot = Plot.plot({
      width,
      marginTop: 40,
      marginBottom: 40,
      height: 250,
      y: {
        label: "Variação (%)",
      },
      x: {
        label: "Ano",
        insetLeft: 36,
        tickSize: 0,
        interval: "year"
      },
      style: {
        fontSize: "12px",
      },
      marks: [
        Plot.axisY({
          tickSize: 0, // don’t draw ticks
          dx: 38, // offset right
          dy: -6, // offset up
          lineAnchor: "bottom", // draw labels above grid lines
          tickFormat: (d) => number_locale.format(".1%")(d)
        }),
        Plot.gridY({
          strokeDasharray: "5 5", // dashed
          strokeOpacity: 1, // opaque
          strokeWidth: 0.2
        }),
        Plot.barY(data_plot, 
          {
            x: "data",
            y: d => d.valor / 100,
            fill: "var(--theme-foreground-focus)",
            tip: {
              format: {
                x: d => d3.utcFormat("%Y")(d),
                y: (d) => number_locale.format(".2%")(d),
              }
            },
            render: anim_vbar    
        })
      ]
    })

    return plot;
}
return {plot_serie,plot_comparacao_mes};
}});

define({id: "342feb8e", mode: "inline", inputs: ["resize","plot_serie","series","display"], body: async (resize,plot_serie,series,display) => {
display(await(
resize((width) => plot_serie(width, series[0]))
))
}});

define({id: "315f4bf7", mode: "inline", inputs: ["resize","plot_serie","series","display"], body: async (resize,plot_serie,series,display) => {
display(await(
resize((width) => plot_serie(width, series[2]))
))
}});

define({id: "2b3073ab", mode: "inline", inputs: ["mes_atual","display"], body: async (mes_atual,display) => {
display(await(
mes_atual
))
}});

define({id: "a748a736", mode: "inline", inputs: ["resize","plot_comparacao_mes","series","display"], body: async (resize,plot_comparacao_mes,series,display) => {
display(await(
resize((width) => plot_comparacao_mes(width, series[0]))
))
}});

define({id: "2b3073ab-1", mode: "inline", inputs: ["mes_atual","display"], body: async (mes_atual,display) => {
display(await(
mes_atual
))
}});

define({id: "074f6f8a", mode: "inline", inputs: ["resize","plot_comparacao_mes","series","display"], body: async (resize,plot_comparacao_mes,series,display) => {
display(await(
resize((width) => plot_comparacao_mes(width, series[1]))
))
}});

define({id: "30f614d9", inputs: ["aq","ipca_grupo","mes_atual","ano_atual","Plot","number_locale","anim_hbar"], outputs: ["plot_grupo"], body: (aq,ipca_grupo,mes_atual,ano_atual,Plot,number_locale,anim_hbar) => {
function plot_grupo(width, serie) {
  const data_plot = aq.from(ipca_grupo)
    .filter(aq.escape(d => d.variavel == serie))
    .filter(aq.escape(d => d.mes == mes_atual && d.ano == ano_atual))
    .filter(d => d.regiao == "Brasil")
    .objects()

  const plot = Plot.plot({
      width,
      height: 250,
      marginLeft: 150,
      y: {
        label: "Grupo",
        tickSize: 0
      },
      x: {
        label: "Variação (%)",
        tickSize: 0,
        tickFormat: number_locale.format(".2%"),
      },
      marks: [    
        Plot.gridX({
          strokeDasharray: "5 5", // dashed
          strokeOpacity: 1, // opaque
          strokeWidth: 0.2
        }),
        Plot.barX(
          data_plot,
          {
            y: "categoria",
            x: d => d.valor / 100,
            fill: "var(--theme-foreground-focus)",
            tip: {
              format: {
                y: d => d,
                x: (d) => number_locale.format(".2%")(d)
              }
            },
            render: anim_hbar       
          }
        )
      ]
    })

    return plot
}
return {plot_grupo};
}});

define({id: "4a097ad1-3", mode: "inline", inputs: ["d3","data_max","display"], body: async (d3,data_max,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_max)
))
}});

define({id: "2888ea03", mode: "inline", inputs: ["resize","plot_grupo","series","display"], body: async (resize,plot_grupo,series,display) => {
display(await(
resize((width) => plot_grupo(width, series[0]))
))
}});

define({id: "4a097ad1-4", mode: "inline", inputs: ["d3","data_max","display"], body: async (d3,data_max,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_max)
))
}});

define({id: "f52191dc", mode: "inline", inputs: ["resize","plot_grupo","series","display"], body: async (resize,plot_grupo,series,display) => {
display(await(
resize((width) => plot_grupo(width, series[1]))
))
}});

define({id: "9f7fb85d-1", mode: "inline", inputs: ["d3","data_min","display"], body: async (d3,data_min,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_min)
))
}});

define({id: "4a097ad1-5", mode: "inline", inputs: ["d3","data_max","display"], body: async (d3,data_max,display) => {
display(await(
d3.utcFormat("%B/%Y")(data_max)
))
}});

define({id: "349be5a3", mode: "inline", inputs: ["resize","plot_grupo","series","display"], body: async (resize,plot_grupo,series,display) => {
display(await(
resize((width) => plot_grupo(width, series[2]))
))
}});

define({id: "9af8ad19", inputs: ["aq","ipca_grupo","Plot","number_locale","d3","anim_heatmap"], outputs: ["plot_heatmap"], body: (aq,ipca_grupo,Plot,number_locale,d3,anim_heatmap) => {
function plot_heatmap(width, serie) {
  const data_plot = aq.from(ipca_grupo)
    .filter(aq.escape(d => d.variavel == serie))
    .filter(d => d.regiao == "Brasil")
    .orderby(["data", "categoria"])
    .objects();

  const plot = Plot.plot({
        width,
        height: 250,
        marginLeft: 150,
        marginBottom: 40,
        x: {label: "Data", interval: "month", tickSize: 0},
        y: {label: "Grupo", tickSize: 0},
        color: {
          label: "Variação",
          legend: true,
          zero: true,
          scheme: "BrBg",
          tickFormat: number_locale.format(".2%"),
        },
        marks: [
          Plot.cell(
            data_plot,
            {
              x: "data",
              y: "categoria",
              fill: (d) => d.valor / 100,
              tip: {
                title: d => d.categoria,
                format: {
                  x: (d) => d3.utcFormat("%B/%Y")(d),
                  fill: (d) => number_locale.format(".2%")(d)
                }
              },
              render: anim_heatmap
            }
          )
        ]
      })

  return plot;
}
return {plot_heatmap};
}});

define({id: "2e723895", mode: "inline", inputs: ["input_serie","display"], body: async (input_serie,display) => {
display(await(
input_serie
))
}});

define({id: "44061b79", mode: "inline", inputs: ["resize","plot_heatmap","serie","display"], body: async (resize,plot_heatmap,serie,display) => {
display(await(
resize((width) => plot_heatmap(width, serie))
))
}});

define({id: "112e856b", inputs: ["Inputs","series","Generators","aq","ipca_subitem","Plot","number_locale","anim_vbar","anim_hbar"], outputs: ["input_serie_sub","serie_sub","plot_histograma","plot_var_subitem"], body: (Inputs,series,Generators,aq,ipca_subitem,Plot,number_locale,anim_vbar,anim_hbar) => {
const input_serie_sub = Inputs.select(
  series, {
    label: "Série",
    format: x => x.slice(7),
    value: series[0],
    width: 360
  });
const serie_sub = Generators.input(input_serie_sub);

function plot_histograma(width, serie) {
  const data_plot = aq.from(ipca_subitem)
    .filter(aq.escape(d => d.variavel == serie))
    .filter(d => d.regiao == "Brasil")
    .orderby(["data", "categoria"])
    .objects();

  const rect_mark = Plot.rectY(
    data_plot,
    Plot.binX(
      {y: "count"},
      {
        x: d => d.valor / 100,
        fill: "var(--theme-foreground-focus)",
        tip: {
          format: {
            x: d => number_locale.format(".2%")(d),          
            // replace "--" for " - -"
            y: d => d,
          }
        },
        render: anim_vbar
      }
    )
  );


  const plot = Plot.plot({
        width,
        height: 250,        
        marginBottom: 40,
        x: {label: "Variação (%)", tickSize: 0, insetLeft: 36, tickFormat: number_locale.format(".2%")},
        y: {label: "Frequência", tickSize: 0},
        marks: [
          Plot.gridY({
            strokeDasharray: "5 5", // dashed
            strokeOpacity: 1, // opaque
            strokeWidth: 0.2
          }),
          Plot.axisY({
            tickSize: 0, // don’t draw ticks
            dx: 38, // offset right
            dy: -6, // offset up
            lineAnchor: "bottom", // draw labels above grid lines
            tickFormat: (d) => number_locale.format(".0f")(d)
          }),
          rect_mark,
        ]
      })

    // const yScale = plot.scale("y");

    // const rects = d3.select(plot)
    //   .selectAll("[aria-label='rect']")
    //   .selectAll("rect");

    // const rects_data = rects.data();
    // rects._groups[0].forEach(
    //   function(d, i) {
    //     const height = d.attributes.height.value;
    //     const y = d.attributes.y.value;
    //     rects_data[i] = {
    //       "height": +height,
    //       "y": +y
    //     };
    //   }
    // );


    // // convert nodes in data
    // rects
    //   .data(rects_data)
    //   .attr("height", 0)
    //   .attr("y", d => yScale.apply(0))
    //   .transition()
    //   .duration(1000)
    //   // # use original height
    //   .attr("y", d => d.y)
    //   .attr("height", d => d.height);

    return plot;
}

function plot_var_subitem(width, serie, selecao, n) {

  let data_plot = aq.from(ipca_subitem)
    .filter(aq.escape(d => d.variavel == serie))
    .filter(d => d.regiao == "Brasil")
    .orderby("valor");
  
  if (selecao == "aumento") {
    data_plot = data_plot.slice(-n)
      .objects();
  } 

  if (selecao == "reducao") {
    data_plot = data_plot.slice(0, n)
      .objects();
  }

  const plot = Plot.plot({
    width,
    height: 250,
    marginBottom: 40,
    marginLeft: 120,
    y: {label: "Subitem", tickSize: 0},
    x: {label: "Variação (%)", tickSize: 0, tickFormat: number_locale.format(".2%")},
    marks: [
      Plot.axisY({
        tickSize: 0, // don’t draw ticks
        lineWidth: 10,
      }),
      Plot.gridX({
        strokeDasharray: "5 5", // dashed
        strokeOpacity: 1, // opaque
        strokeWidth: 0.2
      }),
      Plot.barX(
        data_plot,
        {
          y: "categoria",
          x: d => d.valor / 100,
          fill: selecao == "aumento" ? "var(--theme-foreground-focus)" : "#7e4a0b",
          tip: {
            format: {
              x: d => number_locale.format(".2%")(d),
              y: d => d.categoria
            }
          },
          sort: {y: "x", reverse: selecao == "aumento"},
          render: anim_hbar
        }
      )
    ]
  });

  return plot;

}

return {input_serie_sub,serie_sub,plot_histograma,plot_var_subitem};
}});

define({id: "5108297d", mode: "inline", inputs: ["input_serie_sub","display"], body: async (input_serie_sub,display) => {
display(await(
input_serie_sub
))
}});

define({id: "2a27c67e", mode: "inline", inputs: ["resize","plot_histograma","serie_sub","display"], body: async (resize,plot_histograma,serie_sub,display) => {
display(await(
resize((width) => plot_histograma(width, serie_sub))
))
}});

define({id: "34053888", mode: "inline", inputs: ["resize","plot_var_subitem","serie_sub","display"], body: async (resize,plot_var_subitem,serie_sub,display) => {
display(await(
resize((width) => plot_var_subitem(width, serie_sub, "aumento", 5))
))
}});

define({id: "0d4bdfd3", mode: "inline", inputs: ["resize","plot_var_subitem","serie_sub","display"], body: async (resize,plot_var_subitem,serie_sub,display) => {
display(await(
resize((width) => plot_var_subitem(width, serie_sub, "reducao", 5))
))
}});

define({id: "fa2ae594", inputs: ["d3"], outputs: ["anim_hbar","anim_vbar","anim_heatmap","anim_line"], body: (d3) => {
function anim_hbar(index, scales, values, dimensions, context, next) {
  const el = next(index, scales, values, dimensions, context);

  const rects = d3.select(el)
    .selectAll("rect");

  const rects_data = rects.data();
  rects._groups[0].forEach(
    function(d, i) {
      const x = d.attributes.x.value;
      const width = d.attributes.width.value;
      rects_data[i] = {
        "width": +width,
        "x": +x
      };
    }
  );
  
  const xScale = scales["x"];
  
  rects
    .data(rects_data)
    .attr("x", d => xScale(0.0))
    .attr("width", 0)
    .transition()
    .duration(1000)
    .attr("x", d => Math.min(xScale(0.0), d.x))
    .attr("width", d => d.width);

  return el;
}

function anim_vbar(index, scales, values, dimensions, context, next) {
  const el = next(index, scales, values, dimensions, context);

  const rects = d3.select(el)
    .selectAll("rect");

  const rects_data = rects.data();
  rects._groups[0].forEach(
    function(d, i) {
      const y = d.attributes.y.value;
      const height = d.attributes.height.value;
      rects_data[i] = {
        "height": +height,
        "y": +y
      };
    }
  );
  
  const yScale = scales["y"];
  
  rects
    .data(rects_data)
    .attr("y", d => yScale(0.0))
    .attr("height", 0)
    .transition()
    .duration(1000)
    .attr("y", d => Math.min(yScale(0.0), d.y))
    .attr("height", d => d.height);

  return el;
}

function anim_heatmap(index, scales, values, dimensions, context, next) {
  const el = next(index, scales, values, dimensions, context);

  const rects = d3.select(el)
    .selectAll("rect");

  rects
    .style("opacity", 0)
    .transition()
    .duration(100)
    .delay((d, i) => i * 1)
    .style("opacity", 1);

  return el;
}

function anim_line(index, scales, values, dimensions, context, next) {
  const el = next(index, scales, values, dimensions, context);

  const lines = d3.select(el)
    .selectAll("path");


  const height = context.ownerSVGElement.attributes.height.value;
  const width = context.ownerSVGElement.attributes.width.value;

  const defs = d3.select(el)
      .append('defs')
      .append('clipPath')
      .attr('id', 'clipEvol')
      .append('rect')
      .attr('height', height)
      .attr('width', 0);

  const xScale = scales["x"];

  lines
    .attr('clip-path', `url(#clipEvol)`);

  defs.transition()
    .duration(1000)
    .attr('width', width);

  return el;
}
return {anim_hbar,anim_vbar,anim_heatmap,anim_line};
}});

define({id: "e3b0c442", body: () => {

}});

define({id: "e3b0c442-1", body: () => {

}});

</script>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<div class="observablehq observablehq--block"><!--:4fb6b65a:--></div>
<h1>IPCA</h1>
<h2>Dashboard com informações detalhadas do Índice de Preços ao Consumidor Amplo (IPCA)</h2>
<p>Os dados utilizados neste dashboard são originários do sistema SIDRA do IBGE e estão disponíveis para download <a href="https://sidra.ibge.gov.br/pesquisa/snipc/ipca/tabelas" target="_blank" rel="noopener noreferrer">aqui</a>.</p>
<div class="observablehq observablehq--block"><!--:6985dcd8:--></div>
<div class="observablehq observablehq--block"><!--:e312573b:--></div>
<div class="observablehq observablehq--block"><!--:ecbe3c53:--></div>
<div class="grid grid-cols-3">
  <div class="card">
    <h2>Variação mensal</h2>
    <h1><observablehq-loading></observablehq-loading><!--:97b1525c:--></h1>
    <h3><observablehq-loading></observablehq-loading><!--:4a097ad1:--></h3>
  </div>
  <div class="card">
    <h2>Variação acumulada no ano</h2>
    <h1><observablehq-loading></observablehq-loading><!--:a5925173:--></h1>
    <h3>Janeiro a <observablehq-loading></observablehq-loading><!--:4a097ad1-1:--></h3>
  </div>
  <div class="card">
    <h2>Variação acumulada em 12 meses</h2>
    <h1><observablehq-loading></observablehq-loading><!--:398007da:--></h1>
    <h3><observablehq-loading></observablehq-loading><!--:9f7fb85d:--> a <observablehq-loading></observablehq-loading><!--:4a097ad1-2:--></h3>
  </div>
</div>
<div class="observablehq observablehq--block"><!--:864e3729:--></div>
<div class="observablehq observablehq--block"><!--:a81b4d46:--></div>
<div class="observablehq observablehq--block"><!--:4d25d951:--></div>
<div class="grid grid-cols-2">
  <div class="card">
    <h2>Evolução do variação mensal</h2>
    <observablehq-loading></observablehq-loading><!--:342feb8e:-->
  </div>
  <div class="card">
    <h2>Evolução da variação acumulada em 12 meses</h2>
    <observablehq-loading></observablehq-loading><!--:315f4bf7:-->
  </div>
  <div class="card">
    <h2> Comparações da variação mensal para o mesmo mês - <observablehq-loading></observablehq-loading><!--:2b3073ab:--></h2>
    <observablehq-loading></observablehq-loading><!--:a748a736:-->
  </div>
  <div class="card">
    <h2> Comparações da variação acumulada no ano para o mesmo mês - <observablehq-loading></observablehq-loading><!--:2b3073ab-1:--></h2>
    <observablehq-loading></observablehq-loading><!--:074f6f8a:-->
  </div>
</div>
<div class="observablehq observablehq--block"><!--:30f614d9:--></div>
<div class="grid grid-cols-3">
  <div class="card">
    <h2> Variação do IPCA por grupo - <observablehq-loading></observablehq-loading><!--:4a097ad1-3:--></h2>
    <observablehq-loading></observablehq-loading><!--:2888ea03:-->
  </div>
  <div class="card">
    <h2> Variação do IPCA por grupo - Janeiro a <observablehq-loading></observablehq-loading><!--:4a097ad1-4:--></h2>
    <observablehq-loading></observablehq-loading><!--:f52191dc:-->
  </div>
  <div class="card">
    <h2> Variação do IPCA por grupo - <observablehq-loading></observablehq-loading><!--:9f7fb85d-1:--> a <observablehq-loading></observablehq-loading><!--:4a097ad1-5:--></h2>
    <observablehq-loading></observablehq-loading><!--:349be5a3:-->
  </div>  
</div>
<div class="observablehq observablehq--block"><!--:9af8ad19:--></div>
<div class="card">
  <h2>Variação do IPCA por grupo</h2>
  <observablehq-loading></observablehq-loading><!--:2e723895:-->
</div>
<div class="grid grid-cols-1">
  <div class="card grid-colspan-2">
    <h2>Evolução da variação do IPCA por grupo</h2>
    <observablehq-loading></observablehq-loading><!--:44061b79:-->
  </div>
</div>
<div class="observablehq observablehq--block"><!--:112e856b:--></div>
<div class="card">
  <h2>Variação do IPCA por subitem</h2>
  <observablehq-loading></observablehq-loading><!--:5108297d:-->
</div>
<div class="grid grid-cols-3">
  <div class="card">
    <h2>Distruibuição da variação do IPCA por subitem</h2>    
    <observablehq-loading></observablehq-loading><!--:2a27c67e:-->
  </div>
  <div class="card">
    <h2>Subitens com maiores aumentos</h2>
    <observablehq-loading></observablehq-loading><!--:34053888:-->
  </div>
  <div class="card">
    <h2>Subitens com maiores reduções</h2>
    <observablehq-loading></observablehq-loading><!--:0d4bdfd3:-->
  </div>
</div>
<div class="observablehq observablehq--block"><!--:fa2ae594:--></div>
<div class="observablehq observablehq--block"><!--:e3b0c442:--></div>
<div class="observablehq observablehq--block"><!--:e3b0c442-1:--></div>
<style>

:root {
  --theme-foreground-focus: #25798c;
  --theme-foreground-muted: #ffddc8;
  --theme-foreground-alt-heading: #242424;
}

.hero {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-family: var(--sans-serif);
  margin: 4rem 0 8rem;
  text-wrap: balance;
  text-align: center;
}

.hero h1 {
  margin: 1rem 0;
  padding: 1rem 0;
  max-width: none;
  font-size: 14vw;
  font-weight: 900;
  line-height: 1;
  color:#6f6f6f;
  /* background: linear-gradient(30deg, var(--theme-foreground-focus), currentColor); */
  /* -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text; */
}

.hero h2 {
  margin: 0;
  max-width: 34em;
  font-size: 20px;
  font-style: initial;
  font-weight: 500;
  line-height: 1.5;
  color: var(--theme-foreground-muted);
}

.card h1{
  color: var(--theme-foreground-alt-heading);
}

.card h2 {
  font-weight: bold;
  color: var(--theme-foreground-focus);
}

.card h3 {
  color: var(--theme-foreground-alt-heading);
}

.info {
  font-weight: 300;
  margin-bottom: 0;
  color: var(--theme-foreground-alt-heading);
}

@media (min-width: 640px) {
  .hero h1 {
    font-size: 90px;
  }
}

</style>
</main>
<footer id="observablehq-footer">
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2024-07-18T21:29:14">Jul 18, 2024</a>.</div>
</footer>
</div>
